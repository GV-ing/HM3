# ğŸ¤– HM3 Project: FLIGHT TEST WITH DRONE AND PX4-AUTOPILOT

This repository contains the solution for **Homework 3** of the Robotics Lab class, focused on the implementation of a custom drone, and flight specifications through the px4-autopilot library. The files and directories contained in this repository are those that were modified for the purposes of the assignment. To avoid excessively large downloads, it is necessary to copy the files retrieved from the repository into the corresponding folders of PX4-Autopilot.

## ğŸ“‚ Repository Structure

```
HM3/
â”œâ”€â”€ README.md
â”œâ”€â”€PX4-Autopilot/                                       #
â”‚   â”œâ”€â”€ROMFS\px4fmu_common\init.d-posix\airframes/      #
â”‚   â”‚   â”œâ”€â”€4100_gz_a_100/                               # drone parameters file
â”‚   â”‚   â””â”€â”€CMakeLists.txt/                              # updated CMakeLists
â”‚   â””â”€â”€src\modules\uxrce_dds_client/ 
â”‚       â””â”€â”€dds_topics.yaml/                             # modified file, necessary for 1.b
â””â”€â”€ aerial_robotics/                                    # 
    â”œâ”€â”€ Dockerfile/                                     #
    â”œâ”€â”€ ros2_ws\src/                                    #
    |   â”œâ”€â”€force_land\src/                              #
    |   |   â””â”€â”€force_land_node.cpp                      # modified file to satisfy the requirements of point 2
    |   â”œâ”€â”€offboard_rl\src/                             #
    |   |   â””â”€â”€trajectory_planner.cpp                   # new file added to satisfy the requirements of point 3
    â”‚   â””â”€â”€read_rpy/
    â””â”€â”€ DDS_run.sh/      

```

---
     	
     	
# ğŸ¦¾ HM3 Setup & Usage Guide

To ensure the correct functioning of the assignment, the following packages must be installed and properly integrated into the ROS 2 workspace:

px4_msgs

PX4-Autopilot

Below are the recommended installation steps for a standard Linux environment.
---

## ğŸš€ 0. Install All Necessary Libraries

```bash
git clone https://github.com/PX4/PX4-Autopilot
git clone https://github.com/PX4/px4_msgs
---
```
## ğŸš 1a. Custom Drone

We developed a new drone model using the x500 platform as our reference. Our version (a_100) provides a schematic representation of a droneâ€™s structural layout: it consists of a pair of intersecting bars connected to the motors and to a central body. To initiate the flight simulation with the a_100 drone, the following commands must be executed in two separate terminals: one opened in ros2_ws-/src/PX4-Autopilot, and the other outside the workspace, which is required to launch the ground control system.

### ğŸ“¡ Launch Command

```bash
make px4_sitl gz_a_100
```
```bash
./QGroundControl.sh
```

---


## âš™ï¸ 2a Modified Forced-Landing Procedure. 

We modified the force_land_node.cpp file so that when the drone exceeds an altitude of 20 m, it automatically triggers a forced-landing procedure, which is then immediately interrupted as soon as the operator sends control inputs via the joystick. In this case, it is necessary to use two additional terminals within the workspace, beyond those required to start the simulation and the ground control system: one for the DDS and the other for executing the force_land_node.cpp.

### ğŸ§© How to run

```bash
make px4_sitl gz_a_100
```
```bash
./QGroundControl.sh
```
```bash
./DDS_run.sh
```
```bash
ros2 run force_land force_land
```

---

#### ğŸ•¹ How it works. 
For the correct functioning of point 2a, the drone must reach an altitude greater than 20 m through commands that are not generated by the joystick. Indeed, if the force_land_node.cpp is activated before the drone reaches 20 m, and this altitude is achieved using joystick inputs, the forced-landing procedure is automatically interrupted.

## ğŸ”§ 3a Trajectory Planner. 

For the third task, we created a new file named trajectory_planner.cpp, which implements eight waypoints that define the droneâ€™s trajectory. The drone follows the entire sequence of waypoints without stopping at each individual point.
### ğŸ“ How to run
```bash
make px4_sitl gz_a_100
```
```bash
./DDS_run.sh
```
```bash
ros2 run offboard_rl trajectory_planner
```
---


